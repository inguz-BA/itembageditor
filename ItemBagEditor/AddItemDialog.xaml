<Window x:Class="ItemBagEditor.AddItemDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Add Item to Drop Section" 
        Height="700" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        ToolTip="Add items from the ItemList to your Drop Section with configurable properties like Skill, Luck, Option, Excellent, Socket Count, Elemental, and more. Select a category, search for items, and configure their drop properties.">
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Add Item from ItemList" 
                   FontSize="18" FontWeight="Bold" 
                   Margin="0,0,0,10"/>
        
        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Panel - Item Selection -->
            <GroupBox Grid.Column="0" Header="Item Selection" Margin="0,0,10,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Category Selection -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,10">
                        <Label Content="Category:" Style="{StaticResource ModernLabel}"/>
                        <ComboBox x:Name="cmbCategory" Style="{StaticResource ModernComboBox}"
                                  SelectionChanged="cmbCategory_SelectionChanged"/>
                    </StackPanel>
                    
                    <!-- Search -->
                    <StackPanel Grid.Row="1" Margin="0,0,0,10">
                        <Label Content="Search Items:" Style="{StaticResource ModernLabel}"/>
                        <TextBox x:Name="txtSearch" Style="{StaticResource ModernTextBox}"
                                 TextChanged="txtSearch_TextChanged">
                            <TextBox.ToolTip>
                                <ToolTip Content="Search by name or index..."/>
                            </TextBox.ToolTip>
                        </TextBox>
                    </StackPanel>
                    
                    <!-- Item List -->
                    <Grid Grid.Row="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                                                 <ListBox x:Name="lstItems" Style="{StaticResource ModernListBox}"
                                  SelectionMode="Extended" SelectionChanged="lstItems_SelectionChanged"/>
                        
                                                 <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,5,0,0">
                             <TextBlock x:Name="txtItemCount" Text="0 items" 
                                        Style="{StaticResource ModernTextBlock}"
                                        VerticalAlignment="Center"/>
                             <TextBlock x:Name="txtSelectedCount" Text=" | 0 selected" 
                                        Style="{StaticResource ModernTextBlock}"
                                        VerticalAlignment="Center" Margin="10,0,0,0"/>

                             <Button x:Name="btnClearSelection" Content="Clear Selection" 
                                     Style="{StaticResource ModernButton}" 
                                     Click="btnClearSelection_Click" Margin="5,0,0,0"/>
                         </StackPanel>
                    </Grid>
                </Grid>
            </GroupBox>
            
            <!-- Right Panel - Item Configuration -->
            <GroupBox Grid.Column="1" Header="Item Configuration">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Selected Item Info -->
                        <GroupBox Header="Selected Item" Margin="0,0,0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Item Image Preview -->
                                <Border Grid.Row="0" Grid.Column="0" Grid.RowSpan="3" 
                                        Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="1" 
                                        CornerRadius="3" Padding="5" Margin="0,0,15,0">
                                    <Image x:Name="imgItemPreview" 
                                           Width="64" Height="64" 
                                           Stretch="Uniform"/>
                                </Border>
                                
                                <!-- Item Details - Right side -->
                                <StackPanel Grid.Column="1" Grid.Row="0" Grid.RowSpan="3" 
                                            VerticalAlignment="Center" Margin="0,0,0,0">
                                    
                                    <!-- Name Row -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="Name:" 
                                               Style="{StaticResource ModernLabel}" 
                                               VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" x:Name="txtSelectedItemName" 
                                                   Style="{StaticResource ModernTextBlock}" 
                                                   Text="No item selected" 
                                                   VerticalAlignment="Center"
                                                   TextWrapping="Wrap"/>
                                    </Grid>
                                    
                                    <!-- Category Row -->
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="Category:" 
                                               Style="{StaticResource ModernLabel}" 
                                               VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" x:Name="txtSelectedItemCategory" 
                                                   Style="{StaticResource ModernTextBlock}" 
                                                   Text="-" 
                                                   VerticalAlignment="Center"/>
                                    </Grid>
                                    
                                    <!-- Index Row -->
                                    <Grid Margin="0,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="Index:" 
                                               Style="{StaticResource ModernLabel}" 
                                               VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" x:Name="txtSelectedItemIndex" 
                                                   Style="{StaticResource ModernTextBlock}" 
                                                   Text="-" 
                                                   VerticalAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                        
                        <!-- Item Properties Configuration -->
                        <GroupBox Header="Item Properties">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                                                 <Grid.RowDefinitions>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                     <RowDefinition Height="Auto"/>
                                 </Grid.RowDefinitions>
                                
                                <!-- Column 1 -->
                                <StackPanel Grid.Column="0" Grid.Row="0" Margin="0,0,5,0">
                                    <Label Content="Item Min Level:" Style="{StaticResource ModernLabel}"/>
                                    <TextBox x:Name="txtItemMinLevel" Style="{StaticResource ModernTextBox}" Text="0"
                                             ToolTip="Minimum level the item should drop with. Must be lower or equal to Item Max Level."/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="0" Grid.Row="1" Margin="0,0,5,0">
                                    <Label Content="Item Max Level:" Style="{StaticResource ModernLabel}"/>
                                    <TextBox x:Name="txtItemMaxLevel" Style="{StaticResource ModernTextBox}" Text="0"
                                             ToolTip="Maximum level the item should drop with. Must be greater or equal to Item Min Level."/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="0" Grid.Row="2" Margin="0,0,5,0">
                                    <Label Content="Skill:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbSkill" Style="{StaticResource ModernComboBox}"
                                              ToolTip="0 = No Skill, -1 = Random (50/50% chance), 1 = With Skill">
                                        <ComboBoxItem Content="0 - No Skill" Tag="0"/>
                                        <ComboBoxItem Content="-1 - Random (50/50%)" Tag="-1"/>
                                        <ComboBoxItem Content="1 - With Skill" Tag="1"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="0" Grid.Row="3" Margin="0,0,5,0">
                                    <Label Content="Luck:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbLuck" Style="{StaticResource ModernComboBox}"
                                              ToolTip="0 = No Luck, -1 = Random (50/50% chance), 1 = With Luck">
                                        <ComboBoxItem Content="0 - No Luck" Tag="0"/>
                                        <ComboBoxItem Content="-1 - Random (50/50%)" Tag="-1"/>
                                        <ComboBoxItem Content="1 - With Luck" Tag="1"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="0" Grid.Row="4" Margin="0,0,5,0">
                                    <Label Content="Option:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbOption" Style="{StaticResource ModernComboBox}"
                                              ToolTip="0 = No Option, -1 = Random, 1-7 = With specified option (+4 to +28)">
                                        <ComboBoxItem Content="0 - No Option" Tag="0"/>
                                        <ComboBoxItem Content="-1 - Random" Tag="-1"/>
                                        <ComboBoxItem Content="1 - +4" Tag="1"/>
                                        <ComboBoxItem Content="2 - +8" Tag="2"/>
                                        <ComboBoxItem Content="3 - +12" Tag="3"/>
                                        <ComboBoxItem Content="4 - +16" Tag="4"/>
                                        <ComboBoxItem Content="5 - +20" Tag="5"/>
                                        <ComboBoxItem Content="6 - +24" Tag="6"/>
                                        <ComboBoxItem Content="7 - +28" Tag="7"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="0" Grid.Row="5" Margin="0,0,5,0">
                                    <Label Content="Durability:" Style="{StaticResource ModernLabel}"/>
                                    <TextBox x:Name="txtDurability" Style="{StaticResource ModernTextBox}" Text="0"
                                             ToolTip="Durability value for the item (0-255). Only add to XML if > 0."/>
                                </StackPanel>
                                
                                <!-- Column 2 -->
                                <StackPanel Grid.Column="1" Grid.Row="0" Margin="5,0,0,0">
                                    <Label Content="Excellent:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbExc" Style="{StaticResource ModernComboBox}"
                                              ToolTip="Excellent options: -1=No exc, -2=Random count, -3;X=Specified count, or specific options like 1;2;3">
                                        <ComboBoxItem Content="-1 - No exc option" Tag="-1"/>
                                        <ComboBoxItem Content="-2 - Random count of random options" Tag="-2"/>
                                        <ComboBoxItem Content="-3;1 - 1 random option" Tag="-3;1"/>
                                        <ComboBoxItem Content="-3;2 - 2 random options" Tag="-3;2"/>
                                        <ComboBoxItem Content="-3;3 - 3 random options" Tag="-3;3"/>
                                        <ComboBoxItem Content="-3;4 - 4 random options" Tag="-3;4"/>
                                        <ComboBoxItem Content="-3;5 - 5 random options" Tag="-3;5"/>
                                        <ComboBoxItem Content="-3;6 - 6 random options" Tag="-3;6"/>
                                        <ComboBoxItem Content="-3;7 - 7 random options" Tag="-3;7"/>
                                        <ComboBoxItem Content="-3;8 - 8 random options" Tag="-3;8"/>
                                        <ComboBoxItem Content="-3;9 - 9 random options" Tag="-3;9"/>
                                        <ComboBoxItem Content="1;2;3 - Specific options 1,2,3" Tag="1;2;3"/>
                                        <ComboBoxItem Content="1;2;3;4;5 - Specific options 1,2,3,4,5" Tag="1;2;3;4;5"/>
                                        <ComboBoxItem Content="1;2;3;4;5;6;7;8;9 - All options" Tag="1;2;3;4;5;6;7;8;9"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Grid.Row="1" Margin="5,0,0,0">
                                    <Label Content="Set Item:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbSetItem" Style="{StaticResource ModernComboBox}"
                                              ToolTip="0 = No ancient, 1 = Ancient (random Tier of specified item). Must be added as ancient, otherwise option will be ignored.">
                                        <ComboBoxItem Content="0 - No Ancient" Tag="0"/>
                                        <ComboBoxItem Content="1 - Ancient" Tag="1"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Grid.Row="2" Margin="5,0,0,0">
                                    <Label Content="Socket Count:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbSocketCount" Style="{StaticResource ModernComboBox}"
                                              ToolTip="0 = No sockets, 1-5 = Up to X slots, -2 = Random count (Pentagrams and Socket Items). Item type must be set to 2 in ItemList.xml">
                                        <ComboBoxItem Content="0 - No Sockets" Tag="0"/>
                                        <ComboBoxItem Content="1 - 1 Socket" Tag="1"/>
                                        <ComboBoxItem Content="2 - 2 Sockets" Tag="2"/>
                                        <ComboBoxItem Content="3 - 3 Sockets" Tag="3"/>
                                        <ComboBoxItem Content="4 - 4 Sockets" Tag="4"/>
                                        <ComboBoxItem Content="5 - 5 Sockets" Tag="5"/>
                                        <ComboBoxItem Content="-2 - Random Count" Tag="-2"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Grid.Row="3" Margin="5,0,0,0">
                                    <Label Content="Elemental:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbElementalItem" Style="{StaticResource ModernComboBox}"
                                              ToolTip="0 = No element, 1 = Fire, 2 = Water, 3 = Earth, 4 = Wind, 5 = Darkness, -1 = Random element">
                                        <ComboBoxItem Content="0 - No Element" Tag="0"/>
                                        <ComboBoxItem Content="1 - Fire" Tag="1"/>
                                        <ComboBoxItem Content="2 - Water" Tag="2"/>
                                        <ComboBoxItem Content="3 - Earth" Tag="3"/>
                                        <ComboBoxItem Content="4 - Wind" Tag="4"/>
                                        <ComboBoxItem Content="5 - Darkness" Tag="5"/>
                                        <ComboBoxItem Content="-1 - Random Element" Tag="-1"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                                                 <StackPanel Grid.Column="1" Grid.Row="4" Margin="5,0,0,0">
                                     <Label Content="Errtel Rank:" Style="{StaticResource ModernLabel}"/>
                                     <Grid>
                                         <Grid.ColumnDefinitions>
                                             <ColumnDefinition Width="Auto"/>
                                             <ColumnDefinition Width="*"/>
                                         </Grid.ColumnDefinitions>
                                         
                                         <CheckBox x:Name="chkEnableErrtelRank" Content="Enable" Style="{StaticResource ModernCheckBox}" 
                                                   Margin="0,0,10,0" VerticalAlignment="Center"/>
                                         
                                         <ComboBox x:Name="cmbErrtelRank" Grid.Column="1" Style="{StaticResource ModernComboBox}"
                                                   ToolTip="Defines rank to drop Errtel item with, 1-5. Only applies to Errtel items (Category 12/13, Index 200-299).">
                                             <ComboBoxItem Content="1 - Default" Tag="1" IsSelected="True"/>
                                             <ComboBoxItem Content="2 - Rank 2" Tag="2"/>
                                             <ComboBoxItem Content="3 - Rank 3" Tag="3"/>
                                             <ComboBoxItem Content="4 - Rank 4" Tag="4"/>
                                             <ComboBoxItem Content="5 - Rank 5" Tag="5"/>
                                         </ComboBox>
                                     </Grid>
                                 </StackPanel>
                                
                                <!-- Evolution Stone Options - Only visible for Evolution Stone items -->
                                <StackPanel Grid.Column="1" Grid.Row="5" Margin="5,0,0,0" x:Name="evolutionStonePanel" Visibility="Collapsed">
                                    <Label Content="Evolution Stone Variant:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbEvolutionStoneVariant" Style="{StaticResource ModernComboBox}"
                                              ToolTip="Select which Evolution Stone variant this item will create when used. Only applies to Evolution Stone items."
                                              SelectionChanged="cmbEvolutionStoneVariant_SelectionChanged">
                                        <ComboBoxItem Content="None (Default)" Tag="" IsSelected="True"/>
                                        <ComboBoxItem Content="Nymph (16-216)" Tag="16;216"/>
                                        <ComboBoxItem Content="Safi (16-218)" Tag="16;218"/>
                                        <ComboBoxItem Content="Unknown (16-212)" Tag="16;212"/>
                                        <ComboBoxItem Content="Tempest Variant 1 (16-504)" Tag="16;504"/>
                                        <ComboBoxItem Content="Tempest Variant 2 (16-506)" Tag="16;506"/>
                                        <ComboBoxItem Content="Tempest Variant 3 (16-508)" Tag="16;508"/>
                                    </ComboBox>
                                </StackPanel>
                                
                                <!-- Additional Properties Row 6 -->
                                <StackPanel Grid.Column="0" Grid.Row="6" Margin="0,0,5,0">
                                    <Label Content="Opt Slot Info:" Style="{StaticResource ModernLabel}"/>
                                    <TextBox x:Name="txtOptSlotInfo" Style="{StaticResource ModernTextBox}" Text=""
                                             ToolTip="Option slot information for the item (leave empty for default)"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Grid.Row="6" Margin="5,0,0,0">
                                    <Label Content="Individual Rate:" Style="{StaticResource ModernLabel}"/>
                                    <TextBox x:Name="txtRate" Style="{StaticResource ModernTextBox}" Text="0"
                                             ToolTip="Individual item drop rate (0 = use drop section rate, 1-10000 = specific rate)"/>
                                </StackPanel>
                                
                                <!-- Additional Properties Row 7 -->
                                <StackPanel Grid.Column="0" Grid.Row="7" Margin="0,0,5,0">
                                    <Label Content="Duration (seconds):" Style="{StaticResource ModernLabel}"/>
                                    <TextBox x:Name="txtDuration" Style="{StaticResource ModernTextBox}" Text="0"
                                             ToolTip="Item duration in seconds (0 = permanent, 86400 = 1 day, 2592000 = 30 days, 5184000 = 60 days)"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Grid.Row="7" Margin="5,0,0,0">
                                    <Label Content="Duration Presets:" Style="{StaticResource ModernLabel}"/>
                                    <ComboBox x:Name="cmbDurationPreset" Style="{StaticResource ModernComboBox}"
                                              ToolTip="Quick duration presets for common time periods"
                                              SelectionChanged="cmbDurationPreset_SelectionChanged">
                                        <ComboBoxItem Content="Custom" Tag="0" IsSelected="True"/>
                                        <ComboBoxItem Content="1 Day (86400)" Tag="86400"/>
                                        <ComboBoxItem Content="7 Days (604800)" Tag="604800"/>
                                        <ComboBoxItem Content="30 Days (2592000)" Tag="2592000"/>
                                        <ComboBoxItem Content="60 Days (5184000)" Tag="5184000"/>
                                    </ComboBox>
                                </StackPanel>
                                

                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </GroupBox>
        </Grid>
        
                 <!-- Buttons -->
         <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
             <Button x:Name="btnAdd" Content="Add Selected Items" Style="{StaticResource ModernButton}"
                     Click="btnAdd_Click" Width="120" Margin="0,0,10,0"/>
             <Button x:Name="btnCancel" Content="Cancel" Style="{StaticResource ModernButton}"
                     Click="btnCancel_Click" Width="100"/>
         </StackPanel>
    </Grid>
</Window>
